#include "ex_test.hpp"

TEST_P(MatrixTest, Matrix_dot_P)
{
    auto as = GetParam();

    GTEST_UTILS::EXPECT_FEQ(ex::Matrix::dot(as.x, as.y), as.prod, 5);
}

INSTANTIATE_TEST_SUITE_P(MatrixInstanciation, MatrixTest,
        testing::Values(
        MatrixState{{0.6116385036656158f,0.3962787899764537f,-0.31949896696401625f,-0.6890410003764369f,0.9144261444135624f},
                    {-0.32681090977474647f,-0.8145083132397042f,-0.806567246333072f,0.6949887326949196f,0.20745206273378214f},
                    -0.5541412443923557
        },
        MatrixState{{0.6142565465487604f,0.45946357338763577f,0.07245618290940148f,0.9462315279587412f,-0.24293124558329304f},
                    {0.104081262546454f,0.6588093285059897f,0.2370395047284921f,0.7234138006215545f,0.15470429051352408f},
                    1.0307409027770957
        }
    )
);

TEST_P(ActivationTest, Activation_func_P)
{
    auto as = GetParam();
    as.func(as.z);

    for(size_t i = 0; i < as.z.size(); i++){
        GTEST_UTILS::EXPECT_FEQ(as.z[i], as.a[i], 5);
    }
}

INSTANTIATE_TEST_SUITE_P(ActivationInstanciation, ActivationTest,
        testing::Values(
        ActivationState{ex::Activation::sigmoid,
                        {0.2788535969157675f,-0.9499784895546661f,-0.4499413632617615f,-0.5535785237023545f,0.4729424283280248f},
                        {0.56926514557087f,0.27888914792203123f,0.38937470755111603f,0.3650345633564037f,0.6160799528479489f}
                        },
        ActivationState{ex::Activation::relu,
                        {0.3533989748458226f,0.7843591354096908f,-0.8261223347411677f,-0.15615636062945915f,-0.9404055611238593f},
                        {0.3533989748458226f,0.7843591354096908f,0.f,0.f,0.f}
                        },
        ActivationState{ex::Activation::elu,
                        {-0.5627240503927933f,0.010710576206724776f,-0.9469280606322728f,-0.602324698626703f,0.2997688755590464f},
                        {-0.43034482103468885f,0.010710576206724776f,-0.6120691048993737f,-0.45246270376076336f,0.2997688755590464f}
                        },
        ActivationState{ex::Activation::softmax,
                        {0.08988296120643335f,-0.5591187559186066f,0.17853136775181744f,0.6188609133556533f,-0.987002480643878f},
                        {0.21490978496616275f,0.11230480164535325f,0.23483114919039366f,0.36474420052355366f,0.0732100636745367f}
                        }
        )
);


